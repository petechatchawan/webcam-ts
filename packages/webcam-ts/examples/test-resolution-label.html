<!DOCTYPE html>
<html lang="th">
	<head>
		<meta charset="UTF-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1.0" />
		<title>Test Resolution Label - Webcam-TS</title>
		<style>
			body {
				font-family: "Segoe UI", Tahoma, Geneva, Verdana, sans-serif;
				max-width: 800px;
				margin: 50px auto;
				padding: 20px;
				background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
				color: #fff;
			}
			.container {
				background: rgba(255, 255, 255, 0.1);
				backdrop-filter: blur(10px);
				border-radius: 20px;
				padding: 30px;
				box-shadow: 0 8px 32px 0 rgba(31, 38, 135, 0.37);
			}
			h1 {
				text-align: center;
				margin-bottom: 30px;
			}
			.info-box {
				background: rgba(255, 255, 255, 0.2);
				padding: 20px;
				border-radius: 10px;
				margin: 20px 0;
			}
			.info-box h3 {
				margin-top: 0;
				color: #ffd700;
			}
			.info-item {
				margin: 10px 0;
				font-size: 16px;
			}
			.info-item strong {
				color: #ffd700;
			}
			button {
				background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
				color: white;
				border: none;
				padding: 12px 24px;
				border-radius: 8px;
				cursor: pointer;
				font-size: 16px;
				margin: 5px;
				transition: transform 0.2s;
			}
			button:hover {
				transform: scale(1.05);
			}
			button:disabled {
				opacity: 0.5;
				cursor: not-allowed;
			}
			video {
				width: 100%;
				max-width: 640px;
				border-radius: 10px;
				margin: 20px auto;
				display: block;
			}
			.controls {
				text-align: center;
				margin: 20px 0;
			}
			.success {
				color: #4ade80;
			}
			.error {
				color: #f87171;
			}
		</style>
	</head>
	<body>
		<div class="container">
			<h1>üé• ‡∏ó‡∏î‡∏™‡∏≠‡∏ö Resolution Label</h1>

			<div class="info-box">
				<h3>üìã ‡∏ß‡∏±‡∏ï‡∏ñ‡∏∏‡∏õ‡∏£‡∏∞‡∏™‡∏á‡∏Ñ‡πå</h3>
				<p>
					‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏ß‡πà‡∏≤
					<code>getCurrentResolution()</code>
					‡∏Ñ‡∏∑‡∏ô‡∏Ñ‡πà‡∏≤ label ‡∏ó‡∏µ‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á‡∏ï‡∏≤‡∏°‡∏ó‡∏µ‡πà‡∏Å‡∏≥‡∏´‡∏ô‡∏î (‡πÄ‡∏ä‡πà‡∏ô S720, S1080, S1920) ‡πÅ‡∏ó‡∏ô‡∏ó‡∏µ‡πà‡∏à‡∏∞‡πÄ‡∏õ‡πá‡∏ô "720x720"
				</p>
			</div>

			<video id="videoElement" autoplay playsinline></video>

			<div class="controls">
				<button id="btnS720" onclick="startWithResolution('S720', 720, 720)">
					‡πÄ‡∏õ‡∏¥‡∏î‡∏Å‡∏•‡πâ‡∏≠‡∏á S720 (720x720)
				</button>
				<button id="btnS1080" onclick="startWithResolution('S1080', 1080, 1080)">
					‡πÄ‡∏õ‡∏¥‡∏î‡∏Å‡∏•‡πâ‡∏≠‡∏á S1080 (1080x1080)
				</button>
				<button id="btnS1920" onclick="startWithResolution('S1920', 1920, 1920)">
					‡πÄ‡∏õ‡∏¥‡∏î‡∏Å‡∏•‡πâ‡∏≠‡∏á S1920 (1920x1920)
				</button>
				<button id="btnStop" onclick="stopCamera()" disabled>‡∏õ‡∏¥‡∏î‡∏Å‡∏•‡πâ‡∏≠‡∏á</button>
			</div>

			<div class="info-box" id="resultBox" style="display: none">
				<h3>‚úÖ ‡∏ú‡∏•‡∏Å‡∏≤‡∏£‡∏ó‡∏î‡∏™‡∏≠‡∏ö</h3>
				<div class="info-item">
					<strong>Label ‡∏ó‡∏µ‡πà‡∏Å‡∏≥‡∏´‡∏ô‡∏î:</strong>
					<span id="requestedLabel">-</span>
				</div>
				<div class="info-item">
					<strong>getCurrentResolution().label:</strong>
					<span id="currentLabel" class="success">-</span>
				</div>
				<div class="info-item">
					<strong>Width:</strong>
					<span id="currentWidth">-</span>
				</div>
				<div class="info-item">
					<strong>Height:</strong>
					<span id="currentHeight">-</span>
				</div>
				<div class="info-item">
					<strong>‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞:</strong>
					<span id="testStatus">-</span>
				</div>
			</div>

			<div class="info-box">
				<h3>‚ÑπÔ∏è ‡∏Ñ‡∏≥‡∏≠‡∏ò‡∏¥‡∏ö‡∏≤‡∏¢</h3>
				<ul>
					<li>
						<strong>‡∏Å‡πà‡∏≠‡∏ô‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç:</strong>
						getCurrentResolution() ‡∏à‡∏∞‡∏Ñ‡∏∑‡∏ô‡∏Ñ‡πà‡∏≤ label ‡πÄ‡∏õ‡πá‡∏ô "720x720" ‡πÅ‡∏°‡πâ‡∏ß‡πà‡∏≤‡∏à‡∏∞‡πÄ‡∏õ‡∏¥‡∏î‡∏î‡πâ‡∏ß‡∏¢ S720
					</li>
					<li>
						<strong>‡∏´‡∏•‡∏±‡∏á‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç:</strong>
						getCurrentResolution() ‡∏à‡∏∞‡∏Ñ‡∏∑‡∏ô‡∏Ñ‡πà‡∏≤ label ‡πÄ‡∏õ‡πá‡∏ô "S720" ‡∏ï‡∏≤‡∏°‡∏ó‡∏µ‡πà‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡πÑ‡∏ß‡πâ
					</li>
					<li>
						<strong>‡∏ß‡∏¥‡∏ò‡∏µ‡∏ó‡∏î‡∏™‡∏≠‡∏ö:</strong>
						‡∏Å‡∏î‡∏õ‡∏∏‡πà‡∏°‡πÄ‡∏õ‡∏¥‡∏î‡∏Å‡∏•‡πâ‡∏≠‡∏á‡∏î‡πâ‡∏ß‡∏¢ resolution ‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£ ‡πÅ‡∏•‡πâ‡∏ß‡∏î‡∏π‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå‡∏î‡πâ‡∏≤‡∏ô‡∏•‡πà‡∏≤‡∏á
					</li>
				</ul>
			</div>
		</div>

		<script type="module">
			import { Webcam } from "../dist/index.js";

			const videoElement = document.getElementById("videoElement");
			const webcam = new Webcam();

			window.startWithResolution = async function (label, width, height) {
				try {
					// ‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏•‡∏ó‡∏µ‡πà‡∏Å‡∏≥‡∏´‡∏ô‡∏î
					document.getElementById("requestedLabel").textContent = label;
					document.getElementById("resultBox").style.display = "block";
					document.getElementById("testStatus").textContent = "‚è≥ ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÄ‡∏õ‡∏¥‡∏î‡∏Å‡∏•‡πâ‡∏≠‡∏á...";
					document.getElementById("testStatus").className = "";

					// ‡πÄ‡∏õ‡∏¥‡∏î‡∏Å‡∏•‡πâ‡∏≠‡∏á‡∏î‡πâ‡∏ß‡∏¢ resolution ‡∏ó‡∏µ‡πà‡∏Å‡∏≥‡∏´‡∏ô‡∏î
					await webcam.start({
						videoElement: videoElement,
						preferredResolutions: [{ label: label, width: width, height: height }],
					});

					// ‡∏£‡∏≠‡πÉ‡∏´‡πâ video ‡∏û‡∏£‡πâ‡∏≠‡∏°
					await new Promise((resolve) => {
						if (videoElement.readyState >= 2) {
							resolve();
						} else {
							videoElement.addEventListener("loadeddata", resolve, { once: true });
						}
					});

					// ‡∏î‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• resolution ‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô
					const currentResolution = webcam.getCurrentResolution();

					if (currentResolution) {
						document.getElementById("currentLabel").textContent = currentResolution.label;
						document.getElementById("currentWidth").textContent = currentResolution.width;
						document.getElementById("currentHeight").textContent = currentResolution.height;

						// ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ß‡πà‡∏≤ label ‡∏ï‡∏£‡∏á‡∏Å‡∏±‡∏ô‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà
						if (currentResolution.label === label) {
							document.getElementById("testStatus").textContent = "‚úÖ ‡∏ú‡πà‡∏≤‡∏ô! Label ‡∏ï‡∏£‡∏á‡∏Å‡∏±‡∏ö‡∏ó‡∏µ‡πà‡∏Å‡∏≥‡∏´‡∏ô‡∏î";
							document.getElementById("testStatus").className = "success";
							document.getElementById("currentLabel").className = "success";
						} else {
							document.getElementById(
								"testStatus",
							).textContent = `‚ùå ‡πÑ‡∏°‡πà‡∏ú‡πà‡∏≤‡∏ô! ‡πÑ‡∏î‡πâ "${currentResolution.label}" ‡πÅ‡∏ó‡∏ô‡∏ó‡∏µ‡πà‡∏à‡∏∞‡πÄ‡∏õ‡πá‡∏ô "${label}"`;
							document.getElementById("testStatus").className = "error";
							document.getElementById("currentLabel").className = "error";
						}
					} else {
						document.getElementById("testStatus").textContent =
							"‚ùå ‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏î‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• resolution ‡πÑ‡∏î‡πâ";
						document.getElementById("testStatus").className = "error";
					}

					// Enable stop button
					document.getElementById("btnStop").disabled = false;
					document.getElementById("btnS720").disabled = true;
					document.getElementById("btnS1080").disabled = true;
					document.getElementById("btnS1920").disabled = true;
				} catch (error) {
					console.error("Error:", error);
					document.getElementById("testStatus").textContent = `‚ùå ‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î: ${error.message}`;
					document.getElementById("testStatus").className = "error";
				}
			};

			window.stopCamera = function () {
				webcam.stop();
				document.getElementById("btnStop").disabled = true;
				document.getElementById("btnS720").disabled = false;
				document.getElementById("btnS1080").disabled = false;
				document.getElementById("btnS1920").disabled = false;
				document.getElementById("testStatus").textContent = "‚èπÔ∏è ‡∏õ‡∏¥‡∏î‡∏Å‡∏•‡πâ‡∏≠‡∏á‡πÅ‡∏•‡πâ‡∏ß";
				document.getElementById("testStatus").className = "";
			};
		</script>
	</body>
</html>
